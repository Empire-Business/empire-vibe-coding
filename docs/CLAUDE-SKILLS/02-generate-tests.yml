name: "generate-tests"
description: "Gera testes unitários e de integração seguindo padrões do projeto"
parameters:
  - name: "filePath"
    description: "Caminho do arquivo fonte a ser testado"
    required: true
    type: "string"
  - name: "testFramework"
    description: "Framework de teste preferido"
    required: false
    type: "string"
    default: "vitest"
  - name: "testTypes"
    description: "Tipos de teste a gerar"
    required: false
    type: "array"
    default: ["unit", "integration"]
    items:
      type: "string"
      enum: ["unit", "integration", "e2e", "snapshot"]
  - name: "coverageGoal"
    description: "Meta de coverage para os testes gerados"
    required: false
    type: "number"
    default: 80
  - name: "includeEdgeCases"
    description: "Incluir testes para edge cases"
    required: false
    type: "boolean"
    default: true
  - name: "mockDependencies"
    description: "Mockar dependências externas (APIs, bancos de dados)"
    required: false
    type: "boolean"
    default: true

steps:
  - name: "analyze_source"
    description: "Analisa o arquivo fonte para entender funções exportadas e lógica"

  - name: "identify_test_cases"
    description: "Identifica casos de teste baseado em lógica condicional e fluxos"

  - name: "generate_mocks"
    description: "Gera mocks para dependências externas"

  - name: "write_tests"
    description: "Escreve testes unitários e de integração"

  - name: "validate_syntax"
    description: "Valida sintaxe e imports dos testes"

examples:
  - filePath: "src/features/auth/services/auth.service.ts"
    testTypes: ["unit"]
    coverageGoal: 90
    includeEdgeCases: true

  - filePath: "src/components/forms/LoginForm.tsx"
    testTypes: ["unit", "integration"]
    coverageGoal: 85

  - filePath: "src/app/api/users/route.ts"
    testTypes: ["integration"]
    coverageGoal: 100

output_format: |
  ```typescript
  // [filename].test.tsx
  import { describe, it, expect, vi, beforeEach, afterEach } from 'vitest'
  import { render, screen, fireEvent, waitFor } from '@testing-library/react'
  import userEvent from '@testing-library/user-event'

  // Mocks
  vi.mock('@/lib/supabase', () => ({
    createClient: vi.fn(),
  }))

  // Imports do componente/service sendo testado
  import { ComponentName } from './ComponentName'

  describe('ComponentName', () => {
    beforeEach(() => {
      vi.clearAllMocks()
    })

    // Test cases gerados baseados na análise
    describe('functionality', () => {
      it('should render correctly', () => {
        // Arrange
        const props = {}

        // Act
        render(<ComponentName {...props} />)

        // Assert
        expect(screen.getByRole('button')).toBeInTheDocument()
      })

      it('should handle user interaction', async () => {
        // Arrange
        const user = userEvent.setup()
        const onClick = vi.fn()

        // Act
        render(<ComponentName onClick={onClick} />)
        await user.click(screen.getByRole('button'))

        // Assert
        expect(onClick).toHaveBeenCalledTimes(1)
      })

      it('should show error state', () => {
        // Arrange
        const error = new Error('Test error')

        // Act
        render(<ComponentName error={error} />)

        // Assert
        expect(screen.getByRole('alert')).toHaveTextContent(/error/i)
      })
    })

    describe('edge cases', () => {
      it('should handle null/undefined props', () => {
        render(<ComponentName data={null} />)
        expect(screen.getByText(/no data/i)).toBeInTheDocument()
      })

      it('should handle loading state', () => {
        render(<ComponentName isLoading={true} />)
        expect(screen.getByRole('status')).toBeInTheDocument()
      })
    })
  })
  ```

  **Coverage estimado:** ~[X]%
  **Status:** Pronto para rodar `npm test`

best_practices:
  - "Use Testing Library queries (getByRole, getByLabelText)"
  - "Test behavior, not implementation"
  - "Avoid testing internals directly"
  - "Use userEvent over fireEvent for user interactions"
  - "Test async with waitFor"
  - "Mock external dependencies (API calls, DB)"
  - "Cover happy path and error cases"
